@[TOC](SLAM总结（三）-传感器)
# 一、相机
## 1、单目相机
1.原理
针孔相机原理包括透镜成像原理和感光显像原理。透镜成像原理一般就是通过各种凹凸透镜组成镜头达到小孔成像的原理，本质还是小孔成像。感光显像是通过胶片、CCD和CMOS等感光元件将小孔成的像保存下来。这些和摄影知识密不可分。B站“黄门摄影”很好的介绍了相机的原理，如下图所示。
![B站“黄门摄影”](https://img-blog.csdnimg.cn/20210329001523916.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MTI0NTk4OA==,size_16,color_FFFFFF,t_70#pic_center)
![B站“黄门摄影”](https://img-blog.csdnimg.cn/2021032900152446.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MTI0NTk4OA==,size_16,color_FFFFFF,t_70#pic_center)
合理的曝光才能得到亮度合适的照片，低曝照片会很暗，过曝照片会太亮，甚至全变白。**影响曝光的外因是光源的亮度及其照射物体角度**，如太阳或灯光。**影响曝光的内因有光圈（孔径）的大小、快门（曝光）时间和感光元件的感光度（ISO，感光元件对光的敏感度）**。物体反射光源照来的光（不同颜色反射的不一样），当我们按下快门时物体反射的光从镜头摄入（曝光），感光元件感光后将图片保存下来。在SLAM中，为了适应不同环境，一般不会人为改变光源，光圈越大、快门时间越长和ISO越大图片会越亮。相机一般有自适应系统，会通过一个传感器感受外部光源，然后通过调节光圈、快门和ISO获得合适的曝光，但突然光线变化，相机会来不及反应，会出现短暂过曝和低爆情况，如突然从墙面转向玻璃。
景深和视角（视野）也是摄影的两个主要参数。景深是指焦点前后会比较清晰的一段，其他部分会模糊一些。摄影时一般为了把人拍清楚都会把人放在焦点处前后，这样背景就在景深之外也就模糊了。视角是指小孔射出去光线的最大角度。**景深与光圈和焦距都有关**。**视角与焦距和感光元件尺寸有关**。视角有水平视角、垂直视角和对角视角。
光圈和f值并不是等价关系，光圈大小和f值成反比，f=焦距/镜头孔径大小，焦距是镜头的中心点（小孔）到感光元件的距离，可认为光圈大小是指孔径大小。光圈越大通光量越大（孔径越大），景深越浅。
焦距是指成像平面到镜头光学中心的距离。镜头分为定焦镜头和变焦镜头，定焦镜头结构简单，镜片数少，光线折射扭曲率低，光线损失少，成像质量好。标准镜头感光元件对角线尺寸和焦距一致称为标准镜头，那么对角的视角是45°。焦距越长景深越浅。当感光元件尺度一定时，焦距越长视角也越小，相同物理尺度的物体占据感光元件的尺度变大，造成物体放大的效果。焦距可按如下划分，这也是SLAM中比较重要的概念，长焦镜头大于135mm，中长焦70-135mm，标准35-65，广角镜头小于35mm，鱼眼小于15mm，尼康一款6mm鱼眼视角可达到220°。
![B站“黄门摄影”](https://img-blog.csdnimg.cn/20210402003755342.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MTI0NTk4OA==,size_16,color_FFFFFF,t_70#pic_center)



2.畸变
1）炫光是由于光在镜头里反射再反射到感光元件造成的，镜片越多反射越严重。光圈越小，反射越少。
2）运动模糊：理想情况下，相机和物体都完全静止，那么感光元件上的一个的点只会接收到现实世界中的一个固定点（颜色保持不变）反射的光，图片自然清晰，但剧烈运动时，感光元件上的一个的点会接收到现实世界中的多个点（颜色不同）反射的光，从而造成图片模糊。快门分为卷帘门（逐行曝光）和全局快门。这样卷帘门的曝光总时间时间一般长于全局门，而且每行曝光的时间还不一样，从而更容易造成模糊。
3）径向畸变：镜头的径向畸变产生的原因是放大率差异造成，屈光度越大差异越大。放大率随着光线与光轴所成角度变化而变化。当放大率随半径增大而减小时，会出现桶形畸变，当放大率随半径减小而增大时，会出现枕形畸变。想象一下相机和一张栅格图平行，光轴穿过栅格图中心。那么两种畸变如下，左图中，假设正方形内接圆放大率是1，那么随着半径增大，放大率变小，正方形角点在成像中缩短就出现桶形的效果。枕形刚好相反。
![在这里插入图片描述](https://img-blog.csdnimg.cn/20210402004613384.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MTI0NTk4OA==,size_16,color_FFFFFF,t_70,process=image/rotate,270#pic_center)
广角镜头容易发生桶形畸变
![B站“黄门摄影”](https://img-blog.csdnimg.cn/20210402005349974.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MTI0NTk4OA==,size_16,color_FFFFFF,t_70#pic_center)


长焦镜头容易发生枕形畸变
![B站“黄门摄影”](https://img-blog.csdnimg.cn/20210402005406365.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MTI0NTk4OA==,size_16,color_FFFFFF,t_70#pic_center)


4）切向畸变：由于感光元件装偏造成，如下图所示，想象一下相机和一个圆平行，光轴不穿过圆心，那么在圆弧上每个点的畸变都不一样。若感光元件没装偏，应该落在A~0~上，装偏后落在了A~1~上，发生畸变。
![在这里插入图片描述](https://img-blog.csdnimg.cn/2021040201070323.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MTI0NTk4OA==,size_16,color_FFFFFF,t_70,process=image/rotate,270#pic_center )
3.相机数学模型
相机数学模型是将针孔模型和去畸变模型用数学公式表达出来。理想针孔模型如下图所示，**图中有4个坐标系：真实世界相机坐标系、归一化平面坐标系（一可理解为1m）、感光元件成像坐标系和像素坐标系**。真实世界相机坐标系的原点在相机的光心（针孔），z轴与光轴重合，x轴水平向左（面朝z轴方向），y轴垂直向下。归一化平面坐标系和感光元件成像坐标系的原点是光轴与该平面的角点，坐标系方向与真实世界相机的坐标系一致。像素坐标系就是照片指照片的坐标系，它的原点在照片的左上角。真实世界坐标系下的点a~0~，然后通过针孔模型投影到感光元件成像坐标系下的点a~2~，此时说成的像是倒立的，最后通过离散采样得到像正立的照片。想象一下站着从像素坐标系左边看它就是我们拍摄得到的照片。
![在这里插入图片描述](https://img-blog.csdnimg.cn/20210408001414856.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MTI0NTk4OA==,size_16,color_FFFFFF,t_70#pic_center)
1）针孔成像原理的数学模型
已知a~0~在相机坐标系下的3D坐标（X，Y，Z），待求量是相机在像素坐标系下的坐标（x，y）。首先将3D坐标系（X，Y，Z）投影到归一化平面得到（X/Z，Y/Z，1），然后使用投影矩阵K投影到像素坐标系,公式如下所示,先缩放后平移。f~x~、f~y~是x、y轴的缩放参数，理想情况下，该参数可通过相机的水平视角、垂直视角和相片分辨率求得，假设水平视角为α、	垂直视角为β，分辨率为m*n，则f~x~=m/[2tan(α/2)],f~y~=m/[2tan(β/2)],c~x~、c~y~是归一化平面坐标系原点投影到像素坐标系后在像素坐标系下的平移，理想情况下，该参数可通过相机的相片分辨率求得，c~x~=m/2、c~y~=n/2。实际肯定有所偏差，可以用该值作为参考。
![在这里插入图片描述](https://img-blog.csdnimg.cn/20210408011227519.png#pic_center)


2）去畸变的数学模型
在SLAM中，我们得到的是相机拍得的具有畸变的照片。一般首先在具有畸变的照片提取特征点，然后对这些特征点进行去畸变，去畸变后便能使用投影矩阵进行投影。因而，我们的已知量是具有畸变的点在像素坐标系的坐标（x，y），以及相机的投影矩阵和畸变参数。待求的是去畸变后的特征点在像素坐标系的坐标（x~undistorted~，y~undistorted~）。
一般去畸变主要是去径向畸变和切向畸变。去畸变在归一化平面坐标系进行。
径向畸变的畸变公式为：
x=x~undistorted~（1+k~1~r^2^+k~2~r^4^+k~3~r^6^)
y=y~undistorted~（1+k~1~r^2^+k~2~r^4^+k~3~r^6^)
切向畸变的畸变公式为：
x=x~undistorted~+2p~1~xy+p~2~(r^2^+2x^2^)
x=x~undistorted~+p~1~(r^2^+2y^2^)+2p~2~xy
其中，k~1~、k~2~、p~1~、p~2~、k~3~为畸变参数，r为点在归一化平面坐标系中的半径。
opencv中去畸变的公式如下,公式中先去切向畸变，再去径向畸变：
x~undistorted~={x-[2p~1~xy+p~2~(r^2^+2x^2^)]}/（1+k~1~r^2^+k~2~r^4^+k~3~r^6^)
y~undistorted~={y-[p~1~(r^2^+2y^2^)+2p~2~xy]}/（1+k~1~r^2^+k~2~r^4^+k~3~r^6^)

4.标定
5.误差分析
6.优缺点
7.品牌
## 2、深度相机
### 双目相机
1.原理
2.畸变
3.数学模型
4.标定
5.误差分析
6.优缺点
7.品牌
### 结构光相机
1.原理
2.畸变
3.数学模型
4.标定
5.误差分析
6.优缺点
7.品牌
### ToF相机
1.原理
2.畸变
3.数学模型
4.标定
5.误差分析
6.优缺点
7.品牌
# 二、激光雷达
## 1、2D激光雷达
1.原理
2.畸变
3.数学模型
4.标定
5.误差分析
6.优缺点
7.品牌
## 2、3D激光雷达
1.原理
2.畸变
3.数学模型
4.标定
5.误差分析
6.优缺点
7.品牌
# 三、GPS
1.原理
2.畸变
3.数学模型
4.标定
5.误差分析
6.优缺点
7.品牌
# 四、IMU
1.原理
2.畸变
3.数学模型
4.标定
5.误差分析
6.优缺点
7.品牌
# 五、编码器
1.原理
2.畸变
3.数学模型
4.标定
5.误差分析
6.优缺点
7.品牌
# 六、其他辅助传感器
1.原理
2.畸变
3.数学模型
4.标定
5.误差分析
6.优缺点
7.品牌


